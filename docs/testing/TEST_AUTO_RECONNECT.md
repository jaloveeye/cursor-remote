# 자동 재연결 기능 테스트 가이드

> 작성일: 2026-01-21  
> Phase 1-A Week 1: 연결 안정성

## 테스트 목표

**성공 기준**: 연결 끊김 후 5초 이내 자동 재연결

## 테스트 시나리오

### 시나리오 1: 로컬 서버 연결 끊김 테스트

**준비**:
1. PC 서버 실행 (포트 8767)
2. 모바일 앱 실행
3. 로컬 서버 IP 입력 후 연결

**테스트 단계**:
1. ✅ 연결 성공 확인 (상태: Connected, 아이콘: 초록색)
2. PC 서버 종료 또는 네트워크 끊김
3. ⏱️ 연결 끊김 감지 확인 (상태: Reconnecting, 아이콘: 주황색)
4. ⏱️ 재연결 시도 메시지 확인 ("🔄 재연결 시도 중... (1/5)")
5. PC 서버 재시작
6. ✅ 자동 재연결 성공 확인 (5초 이내)
7. ✅ 재연결 성공 메시지 확인 ("✅ Reconnected to local server")

**예상 결과**:
- 연결 끊김 즉시 감지
- 1초 후 첫 번째 재연결 시도
- PC 서버 재시작 시 즉시 재연결 성공
- 총 재연결 시간: 5초 이내

### 시나리오 2: 릴레이 서버 연결 끊김 테스트

**준비**:
1. PC에서 릴레이 서버에 연결
2. 모바일 앱 실행
3. 세션 ID 입력 후 연결

**테스트 단계**:
1. ✅ 연결 성공 확인
2. 네트워크 끊김 (WiFi 끄기 또는 비행기 모드)
3. ⏱️ 연결 끊김 감지 확인
4. ⏱️ "⚠️ 네트워크 연결 끊김" 메시지 확인
5. 네트워크 복구 (WiFi 켜기)
6. ⏱️ "🌐 네트워크 연결 복구됨" 메시지 확인
7. ✅ 자동 재연결 시도 확인
8. ✅ 재연결 성공 확인

**예상 결과**:
- 네트워크 끊김 즉시 감지
- 네트워크 복구 시 자동 재연결 시도
- 재연결 성공

### 시나리오 3: 지수 백오프 전략 테스트

**준비**:
1. 연결 성공
2. PC 서버 종료 (재시작하지 않음)

**테스트 단계**:
1. 연결 끊김
2. ⏱️ 1초 후 첫 번째 재시도 확인
3. ⏱️ 2초 후 두 번째 재시도 확인
4. ⏱️ 5초 후 세 번째 재시도 확인
5. ⏱️ 10초 후 네 번째 재시도 확인
6. ⏱️ 30초 후 다섯 번째 재시도 확인
7. ✅ 최대 재시도 횟수 초과 메시지 확인

**예상 결과**:
- 재시도 간격: 1s → 2s → 5s → 10s → 30s
- 최대 5회 재시도 후 에러 표시
- "❌ 최대 재연결 시도 횟수 초과" 메시지

### 시나리오 4: 수동 연결 해제 테스트

**준비**:
1. 연결 성공

**테스트 단계**:
1. "Disconnect" 버튼 클릭
2. ✅ 연결 해제 확인
3. PC 서버 종료
4. ⏱️ 자동 재연결 시도하지 않음 확인

**예상 결과**:
- 수동 연결 해제 시 자동 재연결 비활성화
- 재연결 시도 메시지 없음

### 시나리오 5: 연결 상태 UI 테스트

**테스트 단계**:
1. 연결 전: 상태 "Disconnected", 아이콘 회색
2. 연결 중: 상태 "Connecting...", 아이콘 주황색
3. 연결 성공: 상태 "Connected", 아이콘 초록색
4. 재연결 중: 상태 "Reconnecting...", 아이콘 주황색
5. 에러: 상태 "Connection Error", 아이콘 빨간색

**예상 결과**:
- 각 상태별로 올바른 아이콘과 색상 표시
- 상태 텍스트가 명확하게 표시됨

## 테스트 체크리스트

- [ ] 시나리오 1: 로컬 서버 연결 끊김 테스트
- [ ] 시나리오 2: 릴레이 서버 연결 끊김 테스트
- [ ] 시나리오 3: 지수 백오프 전략 테스트
- [ ] 시나리오 4: 수동 연결 해제 테스트
- [ ] 시나리오 5: 연결 상태 UI 테스트

## 성공 기준

✅ **모든 시나리오 통과**
- 연결 끊김 후 5초 이내 자동 재연결
- 네트워크 상태 변화 즉시 감지
- 사용자가 연결 상태를 한눈에 파악 가능

## 알려진 이슈

- 없음 (테스트 후 업데이트)

---

**테스트 완료 후**: 결과를 기록하고 이슈가 있으면 GitHub Issues에 등록하세요.
