---
description: Git Flow 규칙 - 모든 코드 변경은 Git Flow를 따라야 함 (강화된 규칙)
alwaysApply: true
---

# Git Flow 규칙 (강화 버전)

## ⚠️ 필수 규칙 - 절대 위반 금지

**모든 코드 변경 작업은 반드시 Git Flow 규칙을 따라야 합니다. 이 규칙을 위반하면 안 됩니다.**

## 🚫 금지 사항 (절대 금지)

1. ❌ **`main` 브랜치에 직접 커밋 절대 금지**
2. ❌ **`develop` 브랜치에 직접 커밋 절대 금지** (문서만 수정하는 경우도 feature 브랜치 권장)
3. ❌ **`git merge` 직접 사용 금지** - 반드시 `git flow feature finish` 또는 `git flow bugfix finish` 사용
4. ❌ **브랜치 확인 없이 커밋 금지**

## 📋 작업 전 필수 절차

코드 변경 작업을 시작하기 전에 **반드시** 다음 순서를 따라야 합니다:

### Step 1: 현재 브랜치 확인 (필수)
```bash
git branch --show-current
```

### Step 2: 브랜치 판단
- **`main` 또는 `develop`에 있으면**: 즉시 feature/bugfix 브랜치 생성 필요
- **`feature/*` 또는 `bugfix/*`에 있으면**: 작업 진행 가능

### Step 3: 브랜치 생성 (필요한 경우)
```bash
# develop 브랜치로 이동
git checkout develop
git pull origin develop

# feature 브랜치 생성 (새 기능)
git flow feature start <feature-name>

# 또는 bugfix 브랜치 생성 (버그 수정)
git flow bugfix start <bugfix-name>
```

### Step 4: 작업 진행
- 코드 변경
- 커밋 (Conventional Commits 형식)

### Step 5: 작업 완료 (사용자가 직접 실행)
```bash
# Feature 완료
git flow feature finish <feature-name>

# Bugfix 완료
git flow bugfix finish <bugfix-name>
```

**⚠️ 중요**: `git flow feature finish` 또는 `git flow bugfix finish`는 사용자가 명시적으로 요청하지 않는 한 AI가 자동으로 실행하지 않습니다.

## 커밋 메시지 규칙

### 형식
```
<type>: <subject>

<body>

<footer>
```

### Type 종류
- `feat`: 새로운 기능
- `fix`: 버그 수정
- `docs`: 문서만 변경
- `style`: 코드 스타일 변경 (의미 변경 없음)
- `refactor`: 리팩토링
- `test`: 테스트 추가/수정
- `chore`: 빌드 프로세스 또는 보조 도구 변경

### 예시
```
feat: 세션 격리 및 클라이언트 제어 세션 관리

- 클라이언트별 독립적인 세션 관리
- WebSocket 연결 시 고유 clientId 자동 생성
- 클라이언트에서 새 세션 시작 여부 결정

Closes #123
```

## 작업 흐름 체크리스트

코드 변경 작업을 시작할 때:

1. ✅ 현재 브랜치 확인 (`git branch --show-current`)
2. ✅ `main` 또는 `develop`에 있으면 feature/bugfix 브랜치 생성
3. ✅ 작업 진행
4. ✅ 커밋 (Conventional Commits 형식)
5. ✅ 작업 완료 시 `git flow feature finish` 또는 `git flow bugfix finish`

## 🤖 AI Assistant 강화된 가이드라인

코드 변경 작업을 할 때 AI는 다음 규칙을 **반드시** 따라야 합니다:

### 1. 커밋 전 필수 확인 (절대 생략 불가)
- **모든 커밋 전에 반드시 현재 브랜치 확인**
- `git branch --show-current` 또는 `git status`로 확인
- `main` 또는 `develop`에 있으면 **즉시 중단하고 브랜치 생성**

### 2. 브랜치 생성 강제
- `main` 또는 `develop`에 있으면:
  - ❌ **절대 커밋하지 않음**
  - ✅ **반드시 feature/bugfix 브랜치 생성 후 작업**
  - 새 기능: `git flow feature start <name>`
  - 버그 수정: `git flow bugfix start <name>`
  - 문서 수정: `git flow feature start docs-<description>`

### 3. 커밋 메시지 형식 준수
- Conventional Commits 형식 사용
- `feat:`, `fix:`, `docs:`, `chore:` 등 적절한 type 사용

### 4. 작업 완료 시 (사용자 명시적 요청 시에만)
- 사용자가 명시적으로 "finish" 또는 "feature finish" 요청 시에만 실행
- `git flow feature finish` 또는 `git flow bugfix finish` 사용
- 직접 `git merge` 사용 절대 금지

### 5. 에러 처리
- `main` 또는 `develop`에서 커밋 시도 감지 시:
  - 즉시 중단
  - 사용자에게 브랜치 생성 필요 안내
  - 브랜치 생성 후 작업 재개

## 📝 예외 상황 (매우 제한적)

- **문서만 수정하는 경우**: feature 브랜치 권장 (`git flow feature start docs-<description>`)
- **긴급 수정 (hotfix)**: `main`에서 `hotfix/*` 브랜치 생성 (`git flow hotfix start <name>`)

## ⚠️ 중요 사항 (반복 강조)

1. **절대 `main` 브랜치에 직접 커밋하지 마세요!**
2. **절대 `develop` 브랜치에 직접 커밋하지 마세요!**
3. **절대 `git merge`를 직접 사용하지 마세요!**
4. **커밋 전에 반드시 브랜치를 확인하세요!**
5. **`git flow feature finish`는 사용자가 명시적으로 요청할 때만 실행하세요!**

## 🔍 체크리스트 (모든 커밋 전)

코드 변경 작업을 시작하기 전에:
1. ✅ 현재 브랜치 확인 (`git branch --show-current`)
2. ✅ `main` 또는 `develop`이면 브랜치 생성
3. ✅ feature/bugfix 브랜치에서 작업 진행
4. ✅ 커밋 메시지 형식 확인
5. ✅ 작업 완료 시 `git flow feature finish` 사용 (사용자 요청 시)
